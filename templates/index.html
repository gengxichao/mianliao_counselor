<!DOCTYPE html>
<html>
 <head> 
  <title>è¾…å¯¼å‘˜æµ‹è¯„ - å…é¢èŠ</title> 
  <meta charset="utf-8" /> 
  <meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link href="https://cdn.bootcss.com/element-ui/2.0.5/theme-chalk/index.css" rel="stylesheet" /> 
  <script src="https://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script>
  <style>
        .el-header, .el-footer {
        color: #333;
        text-align: center;
        line-height: 60px;
        }

        .el-footer p{
            line-height: 30px;
        }
        </style> 
 </head> 
 <body> 
  <div id="app"> 
    <el-row type="flex" justify="center">
        <el-col :xs="24" :sm="24" :md="24" :lg="10" :xl="10">
   <el-container> 
    <el-header>
     UESTC è¾…å¯¼å‘˜æµ‹è¯„
    </el-header> 
    <el-main> 
     <el-form ref="form" :rules="rules" :model="form" label-width="80px" v-loading="loading" element-loading-text="æ‹¼å‘½ç”Ÿæˆä¸­" element-loading-spinner="el-icon-loading"> 
      <el-form-item label="ç”¨æˆ·å" prop="username"> 
       <el-input v-model="form.username" placeholder="é€šå¸¸ä¸ºå­¦å·æˆ–è€…å½•å–é€šçŸ¥ä¹¦å·" clearable=""></el-input> 
      </el-form-item> 
      <el-form-item label="å¯†ç " prop="password"> 
       <el-input type="password" v-model="form.password" placeholder="é€šå¸¸å’Œä½ çš„é—¨æˆ·å¯†ç ç›¸åŒ" clearable=""></el-input> 
      </el-form-item> 
      <el-form-item> 
       <el-button type="primary" @click="submitForm">
        è¿›å…¥è¯„ä»·ç³»ç»Ÿ
       </el-button> 
       <el-button @click="resetForm">
        æ¸…ç©º
       </el-button> 
      </el-form-item> 
     </el-form> 
    </el-main> 
    <el-footer> 
     <p>æœ¬ç½‘ç«™ä»…ä½œæŠ€æœ¯ç ”ç©¶ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ã€‚</p> 
     <p>
        By Xichao Geng ğŸµ 
    </p>
    <p>
        <iframe src="https://ghbtns.com/github-btn.html?user=gengxichao&amp;type=follow&amp;count=false" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>
        <wb:follow-button uid="1739492152" type="red_1" width="67" height="24" style="display:inline-block;"></wb:follow-button>
    </p> 
     <p>Github repo</p>
     <p>
     <iframe src="https://ghbtns.com/github-btn.html?user=gengxichao&amp;repo=mianliao_counselor&amp;type=star&amp;count=true" frameborder="0" scrolling="0" width="72px" height="20px"></iframe>
    </p> 
    </el-footer> 
   </el-container> 
   </el-col>
   </el-row>
  </div>  
  <script src="https://cdn.bootcss.com/vue/2.5.9/vue.js"></script> 
  <script src="https://cdn.bootcss.com/vue-resource/1.3.4/vue-resource.js"></script> 
  <script src="https://cdn.bootcss.com/element-ui/2.0.5/index.js"></script> 
  <script>
    var Main = new Vue({
    el: "#app",
    data: function() {
    return {
    form: {
    username: '',
    password: ''
    },
    rules:{
    username:[{required: true, message: "è¯·å¡«å†™ç”¨æˆ·å", trigger: 'blur'}],
    password:[{required:true, message: "è¯·å¡«å†™å¯†ç ", trigger: 'blur'}]
    },
    loading: false,
    alertInfo: "",
    showAlert: false
    }
    },
    methods: {
    submitForm() {
    this.$refs['form'].validate((valid) => {
    if (valid) {
    this.loading = true

    this.$http.post("/", this.form).then((resp)=>{
    user = resp.body
    console.log(user)
    if(user.code == 1)
    {
    let uid = user.response.uid
    let token = user.response.token
    url = `http://dev.tjut.cc:92/?uid=${uid}&token=${token}&source=ml`
    console.log(url)
    this.loading = false
    this.$message({
    dangerouslyUseHTMLString: true,
    message: `æˆåŠŸç”Ÿæˆé“¾æ¥ï¼Œå³å°†è‡ªåŠ¨è·³è½¬ï¼Œ<a href="${url}">å¯ä»¥ç‚¹å‡»è¿™é‡Œæ‰‹åŠ¨è·³è½¬</a>`,
    type: 'success',
    duration: 0
    });
    setTimeout(`location.href='${url}'`,3000)
    }else{
    this.$notify.error({
    title: `æ— æ³•ç™»é™†ï¼Œé”™è¯¯ä»£ç ${user.code}`,
    message: 'ä¸€èˆ¬æƒ…å†µä¸‹ä¸ºç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯ï½',
    duration: 0
    });
    this.loading = false
    }
    })
    } else {
    return false;
    }
    });
    },
    resetForm() {
    this.$refs['form'].resetFields();
    },
    closeAlert() {
    this.$refs['form'].resetFields();
    }
    }
    })

    </script> 
 </body>
</html>
